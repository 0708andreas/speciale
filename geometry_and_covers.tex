
\section{Geometric description \& Gröbner covers}
In this section, we develop a geometric description of Gröbner systems. We follow the development of \cite{grb_covers} quite closely, albeit with a slightly different focus. The description makes heavy use of terms from mordern algebraic geometry, specifically the language of sheaves. However, in section \ref{ss_covers}, we relate this abstract description to the $\mathbf{CGS}$ algorithm, which hopefully will provide a translation into more concrete terms. We also provide worked examples throughout, to relate the abstract concepts to the more classical setting.

We will now work over a Noetherian, commutative, reduced (with no nil-potent elements) ring $A$, which in concrete cases can be thought of as $k[U]$, the polynomial ring over the parameters. We let $\Spec(A)$ be the set of prime ideals in $A$, equipped with the Zariski topology, where the closed sets are of the form $\V(I) := \{\mathfrak p \in \Spec(A) \mid I \subset \mathfrak p\}$. Note that maximal ideals are prime ideals, and in the case when $A = k[U]$, ideals on the form $\langle u_{1} - \alpha_{1}, \dots, u_{n} - \alpha_{n} \rangle$ are maximal. Note also, that there is a natural bijection between $\Spec(A/I)$ and $\V(I)$, which we will use implicitly. Given a closed set $Y \subset \Spec(A)$, there is a unique radical ideal $\I(Y) := \bigcap\{I \mid I \subset \p \;\; \forall \p \in Y\}$ such that $Y = \V(\I(Y))$.

Specializations are now given by prime ideals (elements of $\Spec(A)$). Given a prime ideal $\p \in \Spec(A)$, let $A_{\p}$ denote the localization of $A$ by $\p$, which is the set of fractions of the form $\frac{f}{g}$ where $f \in A$ and $g \notin \p$. The residue field at $\p$ is then $k(\p) := A_{\p}/\p_{\p}$, and there is a canonical map $A \to A_{\p}/\p_{\p}$ given by $a \mapsto \frac a 1 + \p_{\p}$. The specialization $\sigma_{\p} : A[X] \to k(\p)[X]$ is this canonical map, applied to each coefficient. If $A = k[U]$ and $\p$ is a maximal ideal $\langle u_{1} - \alpha_{1}, \dots, u_{n} - \alpha_{n} \rangle$, then $\sigma_{\p}$ is simply the evaluation of the parameters at $(\alpha_{1}, \dots, \alpha_{n})$.

Given an open subset $U \subset \Spec(A)$, there is a ring of regular functions on $U$. Let $\fr a = \I(\overline U)$, then a regular function $f$ is a function from $U$ to $\coprod_{\p \in U} (A/\fr a)_{\p}$ which is locally a fraction and $f(\p) \in (A/\fr a)_{\p}$. This means, that any $\p \in U$ there is an open $\p \in U' \subset U$ and $p, q \in A/\fr a$ such that $f(\p') = \frac p q \in (A/\fr a)_{\p'}$ for every $\p' \in U'$. Note that this means $s \notin \p'$.

\begin{example}\label{ex:reg_fun}\upshape
  In classical terms, we can think of regular functions as functions, which can locally be written as fractions of polynomials. For example, on $\V(ad - bc) \setminus \V(a, b) \subset \C^{4}$, there is a regular function $f$ given by $\frac c a$ when $a \neq 0$ and $\frac d b$ when $b \neq 0$. Even though $\V(ad - bc) \setminus \V(a, b)$ isn't open in $\C^{4}$, we can see $\V(ad - bc)$ as a topological subspace of $\C^{4}$ in which $\V(ad - bc) \setminus \V(a, b)$ is open.

  Moving from $\C^{4}$ to $\Spec(\C[a, b, c, d])$, we can identify $\V(ad - bc)$ with $\Spec(\C[a, b, c, d]/\langle ad - bc \rangle)$, so we can equivalently see $f$ as a regular function on $\Spec(\C[a, b, c, d]/\langle ad - bc \rangle) \setminus \V(\langle a, b \rangle)$. This means, for any prime ideal $\p \in \Spec(\C[a, b, c, d]/\langle ad - bc \rangle)$ which doesn't contain $\langle a, b \rangle$, $f$ assigns it an element of $(\C[a, b, c, d]/\langle ad - bc \rangle)_{\p}$. In this case, whenever $\p \nsupset \langle a \rangle$, $f(\p) = \frac c a$ and whenever $\p \nsupset \langle b \rangle$, $f(\p) = \frac d b$. When $\p$ is a maximal ideal, this is equivalent to saying that when $\sigma_{\p}$ doesn't evaluate $a$ to 0, then $f(\p) = \frac c a$, and when $\sigma_{\p}(b) \neq 0$, then $f(\p) = \frac d b$. Since we work in $\C[a, b, c, d]/\langle ad - bc \rangle$, these two fractions agree whenever $\sigma_{\p}(a) \neq 0 \neq \sigma_{\p}(b)$. We are sure that we never have $\sigma_{\p}(a) = \sigma_{\p}(b) = 0$ since $\langle a, b \rangle \nsubset \p$ by assumption.
\end{example}

Similarly to this example, we will often work with regular functions on a locally closed set $S = Y \cap U$, denoted by $\mathcal O_{Y}(U)$ or $\mathcal O_{s}$. We will make good use of the following result about $\mathcal O_{Y}(U)$.

\begin{lemma}\label{lem:O_Y_unique}
  An element of $\mathcal O_{Y}(U)$ is uniquely determined by its images in $k(\p)$ for each $\p \in Y \cap U$.
\end{lemma}
\begin{proof}
  Let $\fr a = \I(Y)$ and let $\rho_{\p} : \mathcal O_{Y}(U) \to (A/\fr a)_{\p}/(\p/\fr a)_{\p}$ be the map given by $\rho_{\p}(f) = f(\p) + (\p/\fr a)_{\p}$. Let $f \in \mathcal O_{Y}(U)$. It is enough to prove that $(\forall \p \in Y \cap U: \rho_{\p}(f) = 0) \implies f = 0$, so assume $f(\p) \in (\p/\fr a)_{\p}$ for any $\p \in Y \cap U$. Then $f \in \bigcap_{\p \in \Spec(A/\fr a)} \p = \sqrt{\langle 0 \rangle} \subset A/\fr a$, so if $A/\fr a$ has no nil-potent elements, then $\sqrt{\langle 0 \rangle} = \langle 0 \rangle$ and thus $f = 0$. Since $\fr a$ was radical, this follows from the assumption that $A$ has no nil-potent elements.
\end{proof}

Given a locally closed set $S \subset \Spec(A)$ take the radical ideal $\fr a = \I(\overline S)$, and consider the polynomial ring $(A/\fr a)[X]$. Let $I \subset A[X]$ be an ideal, and let $\overline I$ denote its image in $(A/\fr a)[X]$. Then we can consider the regular functions in $\overline I$ on $S$, which we denote by $\mathcal I_{S}$, and is given by functions $f$, which can be described locally as fractions $f(\p) = \frac p q$ where $p \in \overline I$ and $q \in (A/\fr a) \setminus \p$. In this light, we can also see $\mathcal I_{S}$ as an ideal in the polynomial ring $\mathcal O_{S}[X]$, which is how we'll use it most of the time.

In an abuse of notation, for a $\p \in \Spec(A/\fr a)$, we denote the map $\mathcal I_{S} \to k(\p) = (A/\fr a)_{\p}/\p_{\p}$ given by mapping $\frac p q \in \mathcal I_{S}$ to $\frac{\sigma_{\p}(p)}{\sigma_{\p}(q)}$ by $\sigma_{\p}$. We can see $\mathcal O_{S}$ as a subring of $\mathcal O_{S}[X]$, so $\sigma_{\p}$ also denotes the evaluation of an element in $\mathcal O_{S}$ at $\p$.

The idea is to describe segments og Gröbner systems, not as point-sets in $k^{|U|}$ with a set of polynomials, but as point-sets in $\Spec(k[U])$ with a set of regular functions. These functions can be evaluated at a maximal ideal, giving a fraction of two polynomials, which can then be specialized at the same maximal ideal, giving a polynomial in $k[X]$. Using regular functions instead of polynomials will allow us to describe not only a Gröbner basis, but the reduced Gröbner basis of a whole segment.

\begin{example}\upshape
  Consider the ideal $I = \langle ax + cy, bx + dy \rangle \subset \C[a, b, c, d][x, y]$ with a term order such that $x > y$ as well as the subset $S = Y \cap U$ where $Y = \V(ad - bc)$ and $U = \C[a, b, c, d] \setminus \V(a, b)$. For any specialization where $ad - bc = 0$ and $a \neq 0$, we can divide the first polynomial by $a$ and reduce the second polynomial with it:
  \[bx + dy - b\left(x + \frac c a y\right) = \left(d - \frac{bc}{a}\right)y = 0\]
  Hence the reduced Gröbner basis is $\{x + \frac c a y\}$. Similarly, if $\,b \neq 0$, then $\{x + \frac d b y\}$ is the reduced Gröbner basis. Let's see how we can describe this using regular functions. The star of the show will be the regular function $f \in \mathcal O_{Y}(U)$ from example~\ref{ex:reg_fun} given by $f(\p) = \frac c a$ if $\p \nsupset \langle a \rangle$ and $f(\p) = \frac d b$ if $\p \nsupset \langle b \rangle$.

  Consider now the polynomial $P = x + f \cdot y \subset \O_{Y}(U)[x, y]$, and let $\mathfrak m \in \Spec(\C[a, b, c, d]/\V(ad - bc))$ be a maximal ideal, which doesn't contain $\langle a, b \rangle$. This is equivalent to $\mathfrak m$ being a maximal ideal in $\C[a, b, c, d]$ of the form $\langle a - m_{1}, b - m_{2}, c - m_{3}, d - m_{3} \rangle$ with the condition that $m_{1} m_{4} - m_{2} m_{3} = 0$ and $m_{1}$ and $m_{2}$ not both being zero. Then $f(\mathfrak m) = x + \frac c a y$ if $m_{1} \neq 0$ and $f(\mathfrak m) = x + \frac d b x$ if $m_{2} \neq 0$.

  Hence \[\sigma_{\mathfrak m}(P) =
    \begin{cases}
      x + \frac{m_{3}}{m_{1}}y & m_{1} \neq 0 \\
      x + \frac{m_{4}}{m_{2}}y & m_{2} \neq 0
    \end{cases}
  \]

  Notice, for any such choice of $m_{1}, \dots, m_{4}$, $\sigma_{\mathfrak m}(P)$ is indeed the reduced Gröbner basis of $\sigma_{\mathfrak m}(I) \subset \C[x, y]$. Lasly, we can write $P = (ax + cy)/a \in I_{\p}$ when $a \neq 0$ and $P = (bx + dy)/b$ when $b \neq 0$. Hence $P \in \mathcal I_{Y}(U)$.
\end{example}

\subsection{Parametric sets}
Parametric Gröbner bases are nice for applications because we have a single object, which is easily translated into a Gröbner basis for any given specialization. However, that translation may include zeros and redundant elements. In particular, there is no way in general to produce a ``parametric reduced Gröbner basis'', i.e. a Gröbner basis which specializes to the reduced Gröbner basis of $\sigma(\langle G \rangle)$ for any specialization $\sigma$. Hence, we might want to find the maximal segments, where we can find such a parametric reduced Gröbner basis. This is the following definition.

\begin{definition}[Parametric set]
  Let $I \subset A[X]$ be an ideal and let $S \subset \Spec(A)$ be locally closed. We say $S$ is a \textit{parametric set for I} if there is a finite set $G \subset \mathcal I_{S}$ such that
  \begin{enumerate}
    \item $\sigma_{\p}(G)$ is the reduced Gröbner basis of $\langle \sigma_{\p}(I) \rangle$ for each $\p \in S$.
    \item For any $g \in G$ and $\p, \p' \in Y$, we have $\langle \LT(\sigma_{\p}(g)) \rangle = \langle \LT(\sigma_{\p'}(g)) \rangle$.
  \end{enumerate}
\end{definition}

Reduced Gröbner bases are supposed to be unique, and indeed that's also the case for the set $G$ in the definition of parametric sets. To prove this, we'll first need a lemma.

\begin{lemma}\label{lem:parametric_grb_unique}
  Let $Y \subset \Spec(A)$ be a closed set and $f, g \in \mathcal I_{Y}$. If $\sigma_{\p}(f) = \sigma_{\p}(g)$ for all $\p \in Y$, then $f = g$.
\end{lemma}
\begin{proof}
  By linearity of $\sigma_{\p}$, we can assume without loss of generality that $f = 0$. We can see $g$ as a polynomial with coefficients in $\mathcal O_{Y}(Y)$. Then $\sigma_{\p}(g) = 0$ means that every coefficient of $g$ lies in $\p_{\p}$. Since this hold for every $\p \in Y$, $g = 0$ by lemma~\ref{lem:O_Y_unique}
\end{proof}

\begin{theorem}\label{thm:red_grb_uniq_and_monic_and_stable}
  Let $S \subset \Spec(A)$ be a parametric set for an ideal $I$ and let $G \subset \mathcal I_{Y}$ be the finite set such that $\sigma_{\p}(G)$ is the reduced Gröbner basis of $\langle \sigma_{\p}(I) \rangle$ for every $\p \in S$. Then $G$ is unique and every $g \in G$ is monic (has invertible leading coefficient) with $\LM(g) = \LM(\sigma_{\p}(g))$ for every $\p \in Y$.
\end{theorem}
\begin{proof}
  Let $F \subset \mathcal I_{Y}$ be a finite set satisfying the two conditions for $Y$ to be a parametric set. For any fixed $f \in F$ and $\p \in Y$, there is then a $g \in G$ such that $\sigma_{\p}(f) = \sigma_{\p}(g)$. Since $\LM(\sigma_{\p}(f))$ and $\LM(\sigma_{\p}(g))$ is independent of $\p$, we have $\LM(\sigma_{\p}(f)) = \LM(\sigma_{\p}(g))$ for all $\p \in Y$. Since $\sigma_{\p}(F) = \sigma_{\p}(G)$ is a reduced Gröbner basis, there can only be one polynomial with that leading monomial. Hence $\sigma_{\p}(f) = \sigma_{\p}(g)$ for all $\p \in Y$, so $f = g$ by lemma~\ref{lem:parametric_grb_unique}. Thus $F \subset G$, and since the situation is symmetric, $F = G$.

  To see that every $g \in G$ is monic, we observe that since $\sigma_{\p}(g)$ is an element of a reduced Gröbner basis, it's leading coefficient is $1$ for all $\p \in Y$. Since $\LM(\sigma_{\p'}(g)) = \LM(\sigma_{\p}(g))$ for all $\p, \p' \in S$, we have $\sigma_{\p}(\LC(g)) \neq 0$ for all $\p \in S$. Thus $1 = \LC(\sigma_{\p}(g)) = \sigma_{\p}(\LC(g))$, hence $\LC(g) = 1$ by lemma~\ref{lem:O_Y_unique}. And since $\sigma_{\p}(1) = 1$ for any $\p$, we get that $\LM(g) = \LM(\sigma_{\p}(g))$.
\end{proof}

In light of this theorem, for a parametric set $S$, we will call its uniquely determined set of polynomials for its reduced Gröbner basis. In certain ways, they are even more well-behaved than classical reduced Gröbner bases, which the following proposition will show.

\begin{proposition}
  Let $S \subset \Spec(A)$ be a parametric set for an ideal $I$ and let $S' \subset S$ be locally closed. Then $S'$ is also parametric, and there is a canonical map $\mathcal I_{S} \to \mathcal I_{S'}$ which maps the reduced Gröbner basis of $S$ to the reduced Gröbner basis of $S'$.
\end{proposition}
\begin{proof}
  To construct the canonical map, let $\fr a = \I(\overline S)$, $\fr a' = \I(\overline{S'})$. Let $\overline I$ and $\overline{I'}$ be the images of $I$ in $(A/\fr a)[X]$ and $(A/\fr a')[X]$ respectively. Since $\overline S \subset \overline{S'}$, we get $\fr a \subset \fr a'$ and thus an inclusion map $\iota : A/\fr a \to A/\fr a'$. This extends to $\phi : \overline I \to \overline{I'}$, which we can localize for every $\p \in S'$, giving $\phi_{\p} : \overline I_{\p} \to \overline{I'}_{\p}$. Then the map
  \[(g \in \mathcal I_{S}) \mapsto (\p \mapsto \phi_{\p}(g(\p)))\]
  is well-defined since it agrees on every open set, and gives us the desired map, call it $\Phi : \mathcal I_{S} \to \mathcal I_{S'}$.

  Since $\phi_{p}$ was just the localization of an inclusion, we get that $\sigma_{\p}(\phi_{\p}(g)) = \sigma_{\p}(g)$ for any $g$ in $\overline I_{\p}$. Thus we also have $\sigma_{\p}(\Phi(g)) = \sigma_{\p}(g)$ for any $g \in \mathcal I_{S}$. Thus, by lemma~\ref{lem:parametric_grb_unique} $\Phi(G) = G'$ where $G$ and $G'$ are the reduced Gröbner bases for $S$ and $S'$ respectively.
\end{proof}




\subsection{Monic ideals and the reduced Gröbner basis of $\mathcal I_{S}$}
Another pleasant surprise is that the unique reduced Gröbner basis of a parametric set for an ideal $I$, is actually the reduced Gröbner basis of the ideal $\mathcal I_{S} \subset \mathcal O_{S}[X]$. Since a reduced Gröbner basis consists of monic polynomials, this will imply that $\mathcal I_{S}$ is a monic ideal. In fact, that is a sufficient condition for $S$ to be a parametric set. This subsection will be spent proving this, as well as some lemmas which will be useful later.

\begin{definition}[Monic ideal]
  An ideal $I \subset A[X]$ is called \textit{monic} if, for every $m \in \LM(I)$, there is a monic $f \in I$ with $\LM(f) = m$.
\end{definition}

We will use without proof that reduced Gröbner bases exists for monic ideals. If the base ring is a field, then every ideal is monic.

\begin{proposition}\label{prop:exi!_red_grb}
  Let $I \subset A[X]$ be an ideal. Then there exists a unique reduced Gröbner basis of $I$ if and only if $I$ is monic.
\end{proposition}

Before we prove the main content, we need two lemmas. First, for any localized polynomial, we can represent it by a fraction of a polynomial with the same terms.

\begin{lemma}\label{lem:local_poly_rep}
  Let $I \subset A[X]$ be an ideal, $\p \in \Spec(A)$ and $f \in I_{\p}$. Then there exists a $P \in I$ and $Q \in A \setminus \p$ such that $f = \frac P Q \in I_{\p}$ and $\coef(f, t) = 0 \implies \coef(P, t) = 0$.
\end{lemma}
\begin{proof}
  By definition of $I_{\p}$, there is some $p \in I$ and $Q \in A \setminus \p$ such that $f = \frac P Q$. If $\coef(f, t) = 0$, then $\coef(P, t)/Q = 0$. Hence there is a $Q_{t} \in A \setminus \p$ such that $\coef(P, t)\cdot Q_{t} = 0 \in A$. Then
  \[f = \frac{P \cdot \prod_{t}Q_{t}}{Q \cdot \prod_{t}Q_{t}}\] satisfies what we want.
\end{proof}

Secondly, when we embed polynomials in $\mathcal I_{S}$, we preserve their leading monomial.

\begin{lemma}\label{lem:embed_preserves_LM}
  Let $S \subset \Spec(A)$ be a locally closed set and $\fr a = \I(\overline Y)$. Let $I \subset A[X]$ be an ideal, let $\overline I \subset (A/\fr a)[X]$ be its image in $(A/\fr a)[X]$, let $P \in \overline I$. Then the leading monomial of $\frac P 1 \in \mathcal I_{S} \subset \mathcal O_{S}[X]$ is equal to the leading monomial of $P$.
\end{lemma}
\begin{proof}
  We will show that there is a $\p \in S$ with $\LC(P) \notin \p$. Indeed, if that was not the case, then $\LC(P) \in \p$ for every $\p \in S$, which would imply $\sigma_{\p}(\LC(P)) = 0$ for every $\p \in S$. Thus $\LC\left(\frac P 1\right) = 0$ since elements of $\mathcal O_{S}$ are determined by $\sigma_{\p}$ by lemma~\ref{lem:O_Y_unique}.

  So assume for a contradiction that $\LC(P) \in \p$ for all $\p \in S$. Then $S \subset W := \V(\LC(P)) = \{\p \in \V(\fr a) \mid \LC(P) \in p\}$. Since $W$ is closed and $S \subset W \subset \overline S$, we get that $W = \V(\fr a)$, thus $\LC(P) \in \p $ for all $\p \in \V(\fr a)$. But since $\fr a$ is radical and so $A/\fr a$ has no nil-potents, this means
  \[\LC(P) \in \bigcap_{\p \in \Spec(A/\fr a)} \p = \sqrt{\langle 0 \rangle} = 0\] hence $\LC(P) = 0$, which is a contradiction.
\end{proof}



\begin{theorem}\label{thm:para_iff_I_S_monic}
  Let $I \subset A[X]$ be an ideal and $S \subset \Spec(A)$ be a locally closed set. Then
  \begin{enumerate}
    \item $S$ is parametric for $I$ if and only if $\mathcal I_{S}$, when seen as a ideal in $\mathcal O_{S}[X]$ is monic.
    \item In the above case, the reduced Gröbner of $\mathcal I_{S}$ is equal to the reduced Gröbner basis for the parametric set $S$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  For the first implication, assume $S$ is parametric for $I$ and let $G \subset \mathcal I_{S}$ be its reduced Gröbner basis. First, we show that $\mathcal I_{S}$ is monic, so let $f \in \mathcal I_{S}$. Then there is some $\p \in S$ such that $\LC(f) \notin \p$, i.e. $\sigma_{\p}(\LC(f)) \neq 0$, since otherwise $\LC(f) = 0$ by lemma~\ref{lem:O_Y_unique}. Since $\sigma_{\p}(G)$ is a Gröbner basis for $\langle \sigma_{\p}(\mathcal I_{S}) \rangle$, there is some $g \in G$ where $\LM(\sigma_{\p}) \mid \LM(\sigma_{\p}(f))$. Since $\LM(g) = \LM(\sigma_{\p}(g))$ by theorem~\ref{thm:red_grb_uniq_and_monic_and_stable} and $\LM(f) = \LM(\sigma_{\p}(f))$, we get $\LM(g) \mid \LM(f)$. Since $g$ is monic, every leading monomial of $\mathcal I_{S}$ is found as the leading monomial of a monic polynomial, so $\mathcal I_{S}$ is monic.

  For the other implication, assume $\mathcal I_{S}$ is monic, let $G = \{g_{1}, \dots, g_{n}\}$ denote its unique reduced Gröbner basis and let $f \in \mathcal I_{S}$. By the division algorithm we can write
  \[f = \sum_{i=1}^{n} f_{i} g_{i}\]
  with $\LM(f_{i})\LM(g_{i}) \leq \LT(f)$ and $\coef(f_{i}, m) \in \langle \coef(f, m') \mid m' \geq m \LT(g_{i}) \rangle \subset A/\I(S)$ for all monomials $m$. The last condition may be unfamiliar if you're used to work over fields, but it simply states that the coefficients of each $f_{i}$ ``comes from'' coefficients in $f$. In other words, we don't use different $g_{i}$ to reduce another $g_{j}$, we only use the $g_{i}$s to reduce $f$.

  The last condition gives us, for any $\p \in S$ that if $\LM(f_{i})\LM(g_{i}) > \LM(\sigma_{\p}(f))$, then $\sigma_{\p}(\LC(f_{i})) \in \langle 0 \rangle$, thus $\sigma_{\p}(\LC(f_{i})) = 0$. Since this holds for every other term of $f_{i}$ as well, we get that $\LM(\sigma_{\p}(f_{i}))\LM(\sigma_{\p}(g_{i})) \leq \LM(\sigma_{\p})(f)$. Since $\sigma_{\p}$ is linear so $\sigma_{\p}(f) = \sum_{i=1}^{n} \sigma_{\p}(f_{i}) \sigma_{\p}(g_{i})$, there must be some $g_{i}$ for which $\LM(\sigma_{\p})(g_{i}) \mid \LM(\sigma_{\p}(f))$. Since every element of $\langle \sigma_{\p}(I) \rangle$ is a scalar multiple of $\sigma_{\p}(f)$ for some $f \in \mathcal I_{S}$, we get that $\sigma_{\p}(G)$ is a Gröbner basis of $\langle \sigma_{\p}(I) \rangle$. Since every $g \in G$ is monic, $\sigma_{\p}(g)$ is also monic, and $\sigma_{\p}(G)$ is reduced because $G$ is. Thus, $\sigma_{\p}(G)$ is the reduced Gröbner basis of $\sigma_{\p}(I)$ for every $\p \in S$, so $S$ is parametric. Furthermore, since $G$ was defined to be the reduced Gröbner basis of $\mathcal I_{S}$, the second assertion follows immediately.
\end{proof}

This theorem gives us, that the parametric Gröbner basis, which was defined as specialising to a reduced Gröbner basis in all points, lifts to a reduced Gröbner basis of $\mathcal I_{S}$. The next theorem is a local test, to determine parametricity.

\begin{theorem}\label{thm:para_iff_I_p_monic}
  Let $S \subset \Spec(A)$ be locally closed, let $\fr a = \I(\overline S)$ and let $\overline I$ be the image of $I$ in $(A/\fr a)[X]$. Then $S$ is parametric if and only if $\overline I_{\p}$ is monic for every $\p \in S$ and $\p \mapsto \LM(\overline I_{\p})$ is constant on $S$. Furthermore, in this case $\LM(\mathcal I_{S}) = \LM(\overline I_{\p})$ for all $\p \in S$.
\end{theorem}
\begin{proof}
  For the first implication, assume $S$ is parametric and let $G \subset \I_{S}$ be its reduced Gröbner basis. Fix some $\p \in S$ and let $\frac P Q \in \overline I_{\p}$. By lemma~\ref{lem:local_poly_rep} we can assume $\LM(P) = \LM\left(\frac P Q\right)$. By lemma~\ref{lem:embed_preserves_LM} the leading monomial $P$ is preserved when we embed it in $\mathcal I_{S}$. Hence $\LM\left(\frac P Q\right) \in \LM(\mathcal I_{S})$, and since the image of $G$ in $\overline I_{\p}$ is monic, it is a reduced Gröbner basis of $\overline I_{\p}$. Hence $\I_{\p}$ is monic and it's leading monomials are constant with $\LM(\overline I_{\p}) = \LM(\mathcal I_{S})$.

  For the other implication, assume $\overline I_{\p}$ is monic for every $\p \in S$, and $\LM(\overline I_{\p}) = \LM(\overline I_{\p'})$ for all $\p, \p' \in S$. Let $\{t_{1}, \dots, t_{n}\}$ be a minimal set of generators of the monomial ideal $\LM(\overline I_{\p})$ (which is independent of $\p$). For each $\p \in S$, let $g_{i}(\p)$ denote the element of the reduced Gröbner basis of $\overline I_{\p}$ with $\LM(g_{i}(\p)) = t_{i}$. Then $g_{i}$ is a function $(\p \in \Spec(S)) \to \overline I_{\p}$, and so is potentially an element of $\mathcal I_{S}$. We just need that it locally can be described by the same fraction. Fix a $\p \in S$ and find $P/Q = g_{i}(\p) \in \overline I_{\p}$ such that $\LM(P) = \LM(g_{i}(\p))$, which exists by lemma~\ref{lem:local_poly_rep}. Also by lemma~\ref{lem:local_poly_rep}, we may assume that $\coef(P, m) = 0$ for all $m \in \LM(\overline I_{\p}) \setminus {t_{i}}$, since that is the case for $g_{i}(\p)$ because it comes from a reduced Gröbner basis. Because $g_{i}(\p)$ is monic, we have $\LC(P)/Q = 1$. Consider the open set $U = \{\p' \in S \mid Q \notin \p'\}$, which is an open neighborhood of $\p$. Then $g_{i}(\p') = P/Q \in \overline I_{\p'}$ for all $\p' \in U$ since $P/Q \in \overline I_{\p'}$ is monic and has leading monomial $t_{i}$ and $\coef\left(P/Q, m\right) = 0$ for all $m \in \LM(\overline I_{\p'})$, which is the defining properties of $g_{i}(\p')$. Thus $g_{i} \in \mathcal I_{S}$.

  This makes the set $G = \{g_{1}, \dots, g_{n}\} \subset \I_{S}$ a good candidate for a Gröbner basis of $\mathcal I_{S}$, which would make $S$ parametric by theorem~\ref{thm:para_iff_I_S_monic} because the $g_{i}$ are monic. So take an $f \in \mathcal I_{S}$. By lemma~\ref{lem:O_Y_unique} there is a $\p \in S$ such that $\sigma_{\p}(\LC(f)) \neq 0$. Letting $\overline f$ denote the image of $f$ in $\overline I \subset (A/\fr a)[X]$ and $\overline f_{\p}$ its image in $\overline I_{\p}$, this implies that $\LC(\overline f) \neq 0$, hence $\LM(f) = \LM(\overline f) = \LM(\overline f_{\p})$. Thus $\LM(\mathcal I_{S}) = \LM(\overline I_{\p}) = \LM(\overline f_{\p})$, so $\LM(\mathcal I_{S}) = \LM(\overline I_{\p}) = \LM(G)$. Thus $\mathcal I_{S}$ is monic, so $S$ is parametric by theorem~\ref{thm:para_iff_I_S_monic}.
\end{proof}

This theorem allows us to characterize the leading monomials of $\mathcal I_{S}$.

\begin{corollary}\label{cor:LM_I_S_eq_LM_overline_I}
  Let $I \subset A[X]$ be an ideal, $S \subset \Spec(A)$ be parametric for $I$, $\fr a = \I(\overline S)$ and let $\overline I$ be the image of $I$ in $(A/\fr a)[X]$. Then $\LM(\mathcal I_{S}) = \LM(\overline I)$.
\end{corollary}
\begin{proof}
  Let $m \in \LM(\mathcal I_{S})$ and $\p \in S$. Theorem~\ref{thm:para_iff_I_p_monic} gives us that $\overline I_{\p} \subset (A/\fr a)_{\p}[X]$ is monic with $\LM(\overline I_{\p}) = \LM(\mathcal I_{S})$. So take some $P/Q \in \overline I_{\p}$ with $\LM(P/Q) = m$. By lemma~\ref{lem:local_poly_rep} we can take $P/Q$ such that $\LM(P) = m$. Hence $\LM(\mathcal I_{S}) \subset \LM(\overline I)$.

  For the reverse inclusion, let $P \in \overline I$. By lemma~\ref{lem:embed_preserves_LM} the element $P/1 \in \mathcal I_{S}$ has $\LM(P/1) = \LM(P)$, so $\LM(\overline I) \subset \LM(\mathcal I_{S})$.
\end{proof}










\subsection{An aside on flatness}
It is proven in \cite{grb_covers} that if $S$ is parametric for an ideal $I$, then the canonical morphism $\phi : \Spec(A[X](I)) \to \Spec(A)$ is flat over $S$. However, the flatness of $\phi$ has no dependence on the monomial order on $I$, while the parametricity of $S$ does. Thus we have the stronger proposition, that $\phi$ is flat over $S$ if there is any monomial order, such that $S$ is parametric for $I$. For example, the ideal $I = \langle ux + y \rangle \subset A[x, y]$ where $A = k[u]$, we have that $\Spec(A)$ is parametric if $y > x$, but not if $x > y$. So flatness of $\phi$ doesn't capture fully the parametricity of $S$.

Consider instead the familiy of rings $\mathcal O_{\{\p\}}/\mathcal I_{\{\p\}}$ indexed by closed points $\p \in S$ for some locally closed set $S \subset \Spec(A)$. We wish to show that $S$ is parametric if and only is this familiy is a flat









\subsection{The singular ideal}
In the last section, we showed that a locally closed set $S$ is parametric for an in deal $I$ if and only if $\mathcal I_{S}$ is a monic ideal in $\mathcal O_{S}[X]$. Given a locally closed set, we can use this to find the maximal parametric subset of $S$. This maximal set is closely linked to the concept of a \textit{lucky} prime ideal. Here, we will only include what we need. For a more in-depth discussion, see \cite{grb_covers}.

\begin{definition}[Lucky prime]\label{def:lucky}
  A prime ideal $\p \in \Spec(A)$ is called \textit{lucky} if $\LC(I, m) \nsubset \p$ for all $m \in \LM(I)$.
\end{definition}

\begin{definition}[Singular ideal]
  Let $I \subset A[X]$ be an ideal and let $M$ be the (unique) minimal set of generators of $\langle \LM(I) \rangle$. The \textit{singular ideal} of $I$ is the radical ideal
  \[\J(I) = \sqrt{\prod_{m \in M} \LC(I, m)}\]
  where $\LC(I, m) = \langle \{\LC(g) \mid g \in I \land \LM(g) = m\} \rangle$.
\end{definition}

We have the following connection between lucky primes and the singular ideal.

\begin{lemma}\label{lem:lucky_iff_not_singular}
  Let $I \subset A[X]$ be an ideal and let $M$ be the unique minimal set of generators of $\langle \LM(I) \rangle$. A prime $\p \in \Spec(A)$ is lucky is and only if $\,\J(I) \nsubset \p$.
\end{lemma}
\begin{proof}
  For the first implication, let $p \in \Spec(A)$ be lucky. For each $m \in M$, let $f_{m} \in I$ have $\LM(f) = m$. Since $\p$ is lucky, we can choose the $f_{m}$ such that $\LC(f_{m}) \notin \p$ for every $m \in M$. Since $\p$ is prime, we thus have $\prod_{m \in M} \LC(f_{m}) \notin \p$. Thus $\J(I) \nsubset \p$.

  The reverse implication we prove by contraposition, so assume that $\p$ is unlucky. $\p$ begin unlucky means there is some $m \in \LM(I)$ with $\LC(I, m) \subset \p$. Now, there is some $m' \in m$ with $m' | m$. We have $\LC(I, m') \subset \LC(I, m)$, thus there is some $m' \in M$ with $\LC(I, m') \subset \p$. Since $\p$ is an ideal, this gives $\prod_{m \in M} \LC(I, m) \subset \p$ and we are done.
\end{proof}



If we have the reduced Gröbner basis of $I$, then $\J(I)$ is particularly easy to compute.

\begin{theorem}
  Let $I \subset A[X]$ be a monic ideal and let $G$ be its reduced Gröbner basis. Then
  \[\J(I) = \sqrt{\left\langle \prod_{g \in G} \LC(g) \right\rangle}\]
\end{theorem}
\begin{proof}
  We show that
  \[\prod_{m \in M} \LC(I, m) = \left\langle \prod_{g \in G} \LC(g) \right\rangle\]
  Let $f$ be a generator of the left side, i.e.\ an element of the form $c_{1}\dots c_{n}$ where each $c_{i}$ is the leading coefficient of a polynomial in $I$, say with leading monomial $m_{i}$. Since $G$ is a Gröbner basis, each $c_{i}m_{i}$ is divisible by a leading term in $G$. Let $\{g_{1}, \dots, g_{n}\} \subset G$ be a set of polynomials such that $g_{i} | c_{i}m_{i}$ for every $i$. Since $G$ is a reduced Gröbner basis, we have $\LM(G) = M$, so every $g \in G$ must occur somewhere in the $\{g_{1}, \dots, g_{n}\}$. Hence
  \[\prod_{g \in G} \LC(g)\; \bigg|\, \prod_{i=1}^{n} c_{i}\]

  On the other hand, $\prod_{g \in G} \LC(g)$ is by definition a generator of the left-side ideal, since $\LM(G) = M$.
\end{proof}

The singular ideal is the radical of the ideal of leading coefficients in $I$. Hence, if we specialize with some $\p \nsubset \J(I)$, then the leading monomial of any polynomial in $\mathcal I$ will remain unchanged. This will turn out to imply parametricity. Note, that it is not enough to have the function $\p \mapsto \LM(\sigma_{\p}(I))$ be constant on $\Spec(A)$. The leading monomials might stay the same, even though some leading coefficients of $I$ vanishes. Take for example the ideal $I = \langle ux - u, ux^{2} - x \rangle \subset \C[u][x]$. Here, we have $\LM(\sigma_{\p}(I)) = \{x\}$ for all $\p \in \Spec(\C[u])$, but $\Spec(\C[u])$ is not parametric. Indeed $\overline I_{\langle u \rangle}$ is not monic, since we can't divide by $u$ in $\C[u]_{\langle u \rangle}$, so $\Spec(\C[u])$ is not parametric for $I$ by theorem~\ref{thm:para_iff_I_p_monic}.

\begin{theorem}\label{thm:Z_gen_para}
  Let $I \subset A[X]$ be an ideal, let $Z \subset \Spec(A)$ be closed and $\fr a = \I(Z)$ and let $\overline I$ be the image of $I$ in $(A/\fr a)[X]$. Then
  \begin{enumerate}
    \item $Z_{gen} := Z \setminus \V(\J(\overline I))$ is parametric for $I$ with $\LM(\mathcal I_{Z_{gen}}) = \LM(\overline I)$.
    \item If $\,Y \subset Z$ is parametric for $I$ with $\LM(\mathcal I_{Y}) = \LM(\overline I)$, then $Y \subset Z_{gen}$.
  \end{enumerate}
\end{theorem}
\begin{proof}
  First, let's show that $Z_{gen}$ is parametric. It is locally closed, so we just need to show that $\mathcal I_{Z_{gen}}$ has a reduced Gröbner basis. Let $m \in \LM(\mathcal I_{Z_{gen}})$. Let $f \in \mathcal I_{Z_{gen}}$ and for each $\p \in Z_{gen}$ let $P_{\p} \in \overline I$ and $Q_{\p} \in (A/\fr a) \setminus \p$ such that $f(\p) = P_{\p}/Q_{\p} \in \overline I_{\p}$, with $\coef(f, m) = 0 \implies \coef(P, m) = 0$ for all monomials $m$. Then $\LM(f) = \LM(P)$. Since each $\p \notin \V(\J(\overline I))$, we can find $P'_{\p} \in \overline I$ such that $\LM(P_{\p}) = \LM(P'_{\p})$ and $\LC(P'_{\p}) \notin \p$.

  Now, we need to produce a monic polynomial $f'$ with the same leading monomial as $f$. Take a finite cover $\{U_{\p} \mid \p \in \fr P\}$ of $Z_{gen}$ such that $f(\p') = \frac{P_{\p}}{Q_{\p}}$ for every $\p' \in U_{\p}$. Let $d = \prod_{\p \in \fr P} \LC(P'_{\p})$ and let $d_{\p} = d/\LC(P'_{\p})$. Since the $\p$ are prime, we have $d \notin \p$ for any $\p \in \fr P$. Thus $\LC(d_{\p} P'_{\p}) \notin \p$. Also




  have $\LC(P) \notin \p$, which gives $\LC(P)\,Q_{\p} \notin \p$ since $\p$ is a prime ideal. Hence
  \[f'(\p) = \frac{P_{\p}}{\LC(P_{\p})\, Q_{\p}}\]
  is a monic polynomial in $\mathcal I_{Z_{gen}}$ with $\LM(f) = \LM(f')$. So $\mathcal I_{Z_{gen}}$ is a monic ideal in $\mathcal O_{Z_{gen}}[X]$, and so $Z_{gen}$ is parametric by theorem~\ref{thm:para_iff_I_S_monic}.

  Now, to show that $Z_{gen}$ is maximal, let $Y \subset Z$ be parametric and assume $\LM(\mathcal I_{Y}) = \LM(\overline I)$. Let $\fr b = \I(\overline Y)$ and let $G \subset \mathcal I_{Y}$ be the reduced Gröbner basis of $\mathcal I_{Y}$. Fix a $\p \in Y$ and a $g \in G$. By lemma~\ref{lem:local_poly_rep} we find a $P/Q = g(\p)$ with $\LM(P) = \LM(g(\p))$. Since $\LM(P) = \LM(g(\p)) = \LM(g) = \LM(\sigma_{\p}(g))$, we have $\LC(P) \notin \p$. Since $Y \subset Z$, that $\p$ is also in $Z$. Furthermore, since $Y \subset Z$, we have $\fr a \subset \fr b$, so $P$ is the image of some $P' \in (A/\fr a)[X]$ in $(A/\fr b)[X]$. Thus $\LC(P)$ is the image of $\LC(P')$ in $A/\fr b$. This means $\LC(P') \notin \p$, hence $\J(\overline I) \nsubset \p$. Since $\p$ was arbitrary, $Y \cap \V(\J(\overline I)) = \emptyset$, so $Y \subset Z_{gen}$.
\end{proof}


\subsection{The projective case}
Let $I \subset A[X]$ be an ideal. In the affine case we've seen that, even though $\LM(\sigma_{\p}(I))$ is constant over all $\p$ in some locally closed set $S$, that does not mean that $S$ is parametric. Thus, it is quite difficult to give a ``canonical'' cover of $\Spec(A)$ with parametric sets. If $I$ is homogenous, we are in luck.

\begin{theorem}
  Let $I \subset A[X]$ be a homogenous ideal and $\p \in \Spec(A)$. Then $\p$ is lucky for $I$ if and only if $\,\LM(\sigma_{\p}(I)) = \LM(I)$.
\end{theorem}
\begin{proof}
  By theorem~\ref{thm:Z_gen_para}, we have the first implication. For the reverse implication, assume that $\LM(\sigma_{\p}(I)) = \LM(I)$ and assume for a contradiction that $\p$ is unlucky for $I$, i.e. there is some $m \in \LM(I)$ with $\LC(I, m) \subset \p$. Since there are only finitely many monomials with the same degree as $m$, we can assume that for every $m'$ with $\deg(m') = \deg(m)$, we have $\LC(I, m') \subset \p \implies m' < m$. Since by assumption $\LM(I) = \LM(\sigma_{\p}(I))$, we can find a $P \in I$ with $\LM(\sigma_{\p}(P)) = m$, and since $I$ is homogenous, we can assume that $P$ is homogenous by lemma \ref{lem:homo_components}. Because $<$ is a well-order, we can take $P$ to have minimal leading monomial, i.e. if $P' \in I$ with $\LM(\sigma_{\p}(P')) = m$ then $\LM(P) < \LM(P')$.

  Since $\LC(I, m) \subset P$, we have $\LT(P) \gneq m$, and because $\deg(\LT(P)) = m$, we have $\LC(I, \LM(P)) \nsubset \p$ since we assumed $m$ to be maximal among the monomials of its degree. Therefor we can find some $Q \in I$ with $\LM(Q) = m = \LM(P)$ and $\LC(Q) \notin \p$. Now, we can construct a new polynomial
  \[P' = \LC(Q)P - \LC(P) Q\]
  which has $\LM(P') < \LM(P)$. However, see that $\coef(P, m') \in \p$ for every $m' > m$ and $\LC(P) \in \p$.Hence, we have $\coef(P', m') \in \p$ for every $m' > m$ since the corresponding terms on both sides of the subtraction has coefficients in $p$. Hence $\LM(\sigma_{\p}(P')) \leq m$. But $\LC(q) \notin \p$ and $\coef(P, m) \notin \p$, so $\LC(Q)\coef(P, m) \notin \p$ since $\p$ is prime. But $\LC(P) \in \p$, so $\coef(P', m) \notin \p$, thus $\LC(\sigma_{\p}(P')) = m$. However, this contradicts the minimality of $P$.
\end{proof}






\subsection{Relation to the $\mathbf{CGS}$ algorithm} \label{ss_covers}
